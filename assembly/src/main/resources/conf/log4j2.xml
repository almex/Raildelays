<?xml version="1.0" encoding="UTF-8"?>
<configuration monitorInterval="30">
	<appenders>
		<Console name="console" target="SYSTEM_OUT">
			<PatternLayout pattern="%m%n" />
		</Console>
        <RollingFile name="railtime-data-reader" fileName="logs/railtime-data.log"
                filePattern="logs/$${date:yyyy-MM}/railtime-data-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="[Reader]: %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
		</RollingFile>
        <RollingFile name="railtime-data-parser" fileName="logs/railtime-data.log"
                filePattern="logs/$${date:yyyy-MM}/railtime-data-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="[Parser]: %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="railtime-data-streamer" fileName="logs/railtime-data.log"
                filePattern="logs/$${date:yyyy-MM}/railtime-data-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="[Streamer]: %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="railtime-data" fileName="logs/railtime-data.log"
                filePattern="logs/$${date:yyyy-MM}/railtime-data-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="[Data]: %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="output" fileName="logs/output.log"
                filePattern="logs/$${date:yyyy-MM}/output-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="%d{DATE} %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="springbatch" fileName="logs/springbatch.log"
                filePattern="logs/$${date:yyyy-MM}/springbatch-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="%d{DATE} %-5p: %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="railtime-route-processor" fileName="logs/railtime-processor.log"
                filePattern="logs/$${date:yyyy-MM}/railtime-processor-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="[Route]: %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="raildelays-xls-processor" fileName="logs/railtime-processor.log"
                filePattern="logs/$${date:yyyy-MM}/railtime-processor-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="[Xls]: %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="raildelays-next-processor" fileName="logs/railtime-processor.log"
                filePattern="logs/$${date:yyyy-MM}/railtime-processor-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="[Next]: %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="raildelays-aggregate-processor" fileName="logs/railtime-processor.log"
                filePattern="logs/$${date:yyyy-MM}/railtime-processor-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="[Aggregate]: %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="raildelays-filter-processor" fileName="logs/railtime-processor.log"
                filePattern="logs/$${date:yyyy-MM}/railtime-processor-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="[Filter]: %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="jdbc" fileName="logs/jdbc.log"
                filePattern="logs/$${date:yyyy-MM}/jdbc-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="%d{HH:mm:ss.SSS} [%t] %level - %m%n%ex%n"/>
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="skipped-items" fileName="logs/skipped-items.log"
                filePattern="logs/$${date:yyyy-MM}/skipped-items-%d{MM-dd-yyyy}-%i.log.gz" append="true">
            <PatternLayout pattern="%d{DATE} %-5p: %m%n" />
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="1 MB"/> 
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
	</appenders>
    
	<loggers>
	
		<logger name="be.raildelays.batch.Bootstrap" level="trace" additivity="false">
	        <appender-ref ref="console" />
	    </logger>    
	    <logger name="be.raildelays.batch.reader" level="trace" additivity="false">
	        <appender-ref ref="railtime-data-reader" />
	    </logger>    
	    <logger name="be.raildelays.httpclient" level="trace" additivity="false">
	        <appender-ref ref="railtime-data-streamer" />
	    </logger>       
	    <logger name="be.raildelays.parser" level="trace" additivity="false">
	        <appender-ref ref="railtime-data-parser" />
	    </logger>
	    <logger name="be.raildelays.repository" level="trace" additivity="false">
	        <appender-ref ref="railtime-data" />
	    </logger>
	    <logger name="be.raildelays.service" level="trace" additivity="false">
	        <appender-ref ref="railtime-data" />
	    </logger>
	    <logger name="be.raildelays.domain.railtime" level="trace" additivity="false">
	        <appender-ref ref="railtime-data" />
	    </logger>
	    <logger name="be.raildelays.batch.processor.RouteLogMapperProcessor" level="trace" additivity="false">
	        <appender-ref ref="railtime-route-processor" />
	    </logger>
	    <logger name="be.raildelays.batch.processor.FilterTwoSensPerDayProcessor" level="trace" additivity="false">
	        <appender-ref ref="raildelays-filter-processor" />
	    </logger>
	    <logger name="be.raildelays.batch.processor.ExcelRowMapperProcessor" level="trace" additivity="false">
	        <appender-ref ref="raildelays-xls-processor" />
	    </logger>
        <logger name="be.raildelays.batch.processor.SearchNextTrainProcessor" level="trace" additivity="false">
            <appender-ref ref="raildelays-next-processor" />
        </logger>
        <logger name="be.raildelays.batch.processor.AggregateExpectedTimeProcessor" level="trace" additivity="false">
            <appender-ref ref="raildelays-aggregate-processor" />
        </logger>
	    <logger name="org.springframework.batch.item.file.FlatFileItemWriter" level="trace" additivity="false">
	        <appender-ref ref="output" />
	    </logger>
	    <logger name="org.springframework.batch" level="debug" additivity="false">
	        <appender-ref ref="springbatch" />
	    </logger>
        <logger name="be.raildelays.batch.listener.LogSkippedItemListener" level="trace" additivity="false">
            <appender-ref ref="skipped-items" />
        </logger>
        <logger name="log4jdbc.log4j2" level="info" additivity="false">
            <MarkerFilter marker="LOG4JDBC_AUDIT" onMatch="ACCEPT" onMismatch="NEUTRAL"/>
            <MarkerFilter marker="LOG4JDBC_RESULTSETTABLE" onMatch="ACCEPT" onMismatch="NEUTRAL"/>
            <appender-ref ref="jdbc"/>
        </logger>


        <root level="warn">
			<appender-ref ref="console" />
		</root>
	</loggers>
</configuration>